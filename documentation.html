<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>libdill</title>
  <link rel="stylesheet" type="text/css" href="http://libdill.org/main.css">
</head>
<body>

<h1>libdill: Structured Concurrency for C</h1>

<ul id='toplist'>
<li><a href="http://libdill.org/index.html">Home</a></li>
<li><a href="http://libdill.org/download.html">Download</a></li>
<li><a href="http://libdill.org/documentation.html">Documentation</a></li>
<li><a href="http://libdill.org/tutorial.html">Tutorial</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<p><a href="build_options.html">Build options</a><br /><a href="compatibility.html">Compatibility</a><br /><a href="threads.html">Threads</a></p>
<ul>
<li><a href="http://libdill.org/man/chdone.html">chdone</a><br /></li>
<li><a href="http://libdill.org/man/chmake.html">chmake</a><br /></li>
<li><a href="http://libdill.org/man/chmake_mem.html">chmake_mem</a><br /></li>
<li><a href="http://libdill.org/man/choose.html">choose</a><br /></li>
<li><a href="http://libdill.org/man/chrecv.html">chrecv</a><br /></li>
<li><a href="http://libdill.org/man/chsend.html">chsend</a><br /></li>
<li><a href="http://libdill.org/man/fdclean.html">fdclean</a><br /></li>
<li><a href="http://libdill.org/man/fdin.html">fdin</a><br /></li>
<li><a href="http://libdill.org/man/fdout.html">fdout</a><br /></li>
<li><a href="http://libdill.org/man/go.html">go</a><br /></li>
<li><a href="http://libdill.org/man/go_mem.html">go_mem</a><br /></li>
<li><a href="http://libdill.org/man/hclose.html">hclose</a><br /></li>
<li><a href="http://libdill.org/man/hdup.html">hdup</a><br /></li>
<li><a href="http://libdill.org/man/hmake.html">hmake</a><br /></li>
<li><a href="http://libdill.org/man/hquery.html">hquery</a><br /></li>
<li><a href="http://libdill.org/man/msleep.html">msleep</a><br /></li>
<li><a href="http://libdill.org/man/now.html">now</a><br /></li>
<li><a href="http://libdill.org/man/yield.html">yield</a></li>
</ul>
<h2 id="faq-how-can-i-report-a-bug">FAQ: How can I report a bug?</h2>
<p>Report a bug here:</p>
<p><a href="https://github.com/sustrik/libdill/issues">https://github.com/sustrik/libdill/issues</a></p>
<h2 id="faq-whats-structured-concurrency">FAQ: What's structured concurrency?</h2>
<p>Check this short introductory <a href="structured-concurrency.html">article</a> about structured concurrency.</p>
<h2 id="faq-whats-libdills-performance">FAQ: What's libdill's performance?</h2>
<p>The best way to find out is to check for yourself. In <code>perf</code> subdirectory you'll find small performance bencharks.</p>
<p>Generally speaking, though, libdill's concurrency primitives only a bit slower than simple C flow control statements. Context switch have been seen to execute in 6 ns, coroutine creation in 26 ns. Passing a message via a channel in 40 ns.</p>
<h2 id="faq-how-does-libdill-concurrency-differ-from-go-concurrency">FAQ: How does libdill concurrency differ from Go concurrency?</h2>
<ol>
<li>No interaction between threads. Each thread is treated as a separate process.<br /></li>
<li>Channels are always unbuffered.<br /></li>
<li><code>choose</code>, unlike <code>select</code> is deterministic. If multiple clauses can be executed, a clause closer to the beginning of the pollset wins.<br /></li>
<li><code>chdone</code> signals closing of the channel to both senders and receivers.<br /></li>
<li>Coroutines can be canceled.</li>
</ol>
<h2 id="faq-how-does-libdill-differ-from-libmill">FAQ: How does libdill differ from libmill?</h2>
<p><code>libmill</code> was a project to copy Go's concurrency model to C 1:1 without introducing any innovations or experiments. The project is finished now. It will be maintained but won't change in the future.</p>
<p><code>libdill</code> is a follow-up project that diverges from the Go model and experiments with structured concurrency.</p>
<p>Technically, there are following differences:</p>
<ol>
<li>It's C-idiomatic. Whereas libmill takes Go's concurrency API and implements them in almost identical manner in C, libdill tries to provide the same functionality via more C-like and POSIX-y API. For example, <code>choose</code> is a function rather than a language construct, Go-style panic is replaced by returning an error code and so on.<br /></li>
<li>Coroutines can be canceled. This creates a foundation for &quot;structured concurrency&quot;.<br /></li>
<li><code>chdone</code> causes blocked <code>recv</code> on the channel to return <code>EPIPE</code> error rather than a value.<br /></li>
<li><code>chdone</code> will signal senders to the channel as well as receivers. This allows for scenarios like multiple senders and single receiver communicating via single channel. The receiver can let the senders know that it's terminating via <code>chdone</code>.<br /></li>
<li>libmill's <code>fdwait</code> was replaced by <code>fdin</code> and <code>fdout</code>. The idea is that if we want data to flow via the connection in both directions in parallel we should use two coroutines rather than single one.<br /></li>
<li>There's no networking library in libdill itself. It is a separate library (dsock).</li>
</ol>
<h2 id="faq-how-can-i-access-source-code">FAQ: How can I access source code?</h2>
<p>To clone the repository:</p>
<pre><code>$ git clone https://github.com/sustrik/libdill.git</code></pre>
<p>To build from the source (you'll need automake and libtool):</p>
<pre><code>$ ./autogen.sh
$ ./configure
$ make
$ make check
$ sudo make install</code></pre>
<p>For easy debugging use the following configure options:</p>
<pre><code>$ ./configure --disable-shared --enable-debug --enable-valgrind</code></pre>
<p>The above will turn the optimisation out, generate debug symbols and link all the tests with the static version of the library. The second option means that the executables in <code>tests</code> subdirectory will be actual debuggable binaries rather that wrapper shell scripts. The last option instructs valgrind about where are the coroutine stacks located and thus prevents spurios valgrind warnings.</p>
<h2 id="faq-is-there-continuous-integration-for-libdill">FAQ: Is there continuous integration for libdill?</h2>
<iframe width="100%" height="20" frameBorder="0"
src="https://api.travis-ci.org/sustrik/libdill.svg?branch=master">
</iframe>


<p>Travis: <a href="https://travis-ci.org/sustrik/libdill">https://travis-ci.org/sustrik/libdill</a></p>
<h2 id="faq-how-can-i-contribute">FAQ: How can I contribute?</h2>
<p>To contribute to libdill create a GitHub pull request. You have to state that your patch is submitted under MIT/X11 license, so that it can be incorporated into the mainline codebase without licensing issues.</p>
<p>If you make a substantial contribution to a file, add your copyright to the file header. Irrespective of whether you do so, your name will be added to the AUTHORS file to indicate you own copyright to a part of the codebase.</p>
<h2 id="faq-what-is-the-release-process">FAQ: What is the release process?</h2>
<p>These instructions are intended for the project maintainers:</p>
<ul>
<li>Run <code>make distcheck</code> to check whether the packaging process still works.<br /></li>
<li>Bump ABI version as appropriate (see here: <a href="http://250bpm.com/blog:41">http://250bpm.com/blog:41</a>).<br /></li>
<li>Commit it and push it back to the master on GitHub.<br /></li>
<li>Tag the new version and push the tag to GitHub (e.g. <code>git tag -a 0.3-beta; git push origin 0.3-beta</code>).<br /></li>
<li>Clone a clean repo from GitHub.<br /></li>
<li>Build the package (<code>./autogen.sh; ./configure; make distcheck</code>).<br /></li>
<li>Add the package to <code>gh-pages</code> branch.<br /></li>
<li>Adjust the download.md in <code>gh-pages</code> branch.<br /></li>
<li>Regenerate the documentaton using <code>./gendocs.sh</code>.<br /></li>
<li>Commit and push to <code>gh-pages</code>.<br /></li>
<li>Announce the release on twitter, etc.</li>
</ul>
</body>
